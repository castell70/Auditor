<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>AuditorMonitor</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />

  <link rel="stylesheet" href="./styles.css" />

  <script type="importmap">
  {
    "imports": {
      "lit": "https://esm.sh/lit@3.1.0",
      "jspdf": "https://esm.sh/jspdf@2.5.1",
      "html2canvas": "https://esm.sh/html2canvas@1.4.1"
    }
  }
  </script>
  <script type="module" src="./main.js"></script>
</head>
<body>
  <header class="top-bar">
    <div class="top-bar-left">AuditorMonitor</div>
    <div class="top-bar-right top-bar-blink">Powered by ITCPO</div>
  </header>

  <main class="app-shell">
    <section class="tab-bar">
      <button class="tab-button active" data-tab="auditoria">Auditor√≠a</button>
      <button class="tab-button" data-tab="participantes">Participantes</button>
      <button class="tab-button" data-tab="etapas">Etapas</button>
      <button class="tab-button" data-tab="calendario">Calendario</button>
      <button class="tab-button" data-tab="diagrama">Diagrama</button>
      <button class="tab-button" data-tab="monitoreo">Monitoreo</button>
      <button id="help-button" class="tab-button tab-button-help" data-tab="ayuda" title="Ayuda">?</button>
    </section>

    <section class="tab-content active" id="tab-auditoria">
      <div class="auditoria-grid">
        <div class="card">
          <div class="card-section">
            <label class="field-label">C√≥digo de auditor√≠a</label>
            <div class="field-row">
              <input id="audit-code" class="field-input" type="text" placeholder="Ej. AUD-2025-01" />
            </div>
            <div class="field-row">
              <select id="audit-selector" class="field-input">
                <option value="">Nueva auditor√≠a</option>
              </select>
              <button id="save-audit" class="btn-primary">Guardar / actualizar</button>
            </div>
          </div>

          <div class="card-section">
            <label class="field-label">Empresa</label>
            <input id="audit-company" class="field-input" type="text" placeholder="Ej. Empresa S.A." />
          </div>
          <div class="card-section">
            <label class="field-label">Nombre de auditor√≠a</label>
            <input id="audit-name" class="field-input" type="text" placeholder="Ej. Auditor√≠a financiera 2025" />
          </div>
          <div class="card-section">
            <label class="field-label">Descripci√≥n de la auditor√≠a</label>
            <input id="audit-description" class="field-input" type="text" placeholder="Breve descripci√≥n de la auditor√≠a (opcional)" />
          </div>
          <div class="card-section">
            <label class="field-label">Fecha</label>
            <input id="audit-date" class="field-input" type="date" />
          </div>
          <div class="card-section">
            <label class="field-label">Auditor l√≠der</label>
            <select id="lead-auditor" class="field-input"></select>
          </div>

          <div class="card-section">
            <div class="field-row">
              <button id="download-json" class="btn-chip">Descargar JSON</button>
              <button id="load-sample" class="btn-chip">Cargar ejemplo</button>
              <button id="load-json" class="btn-chip" title="Cargar datos desde archivo JSON">Cargar JSON</button>
              <button id="reset-app" class="btn-danger" title="Reiniciar la aplicaci√≥n y eliminar todos los datos">Reiniciar</button>
            </div>
          </div>
        </div>

        <div class="card compact">
          <div class="card-header-row">
            <span class="card-title">Resumen</span>
          </div>
          <div class="summary-row">
            <div class="summary-item">
              <span class="summary-label">Participantes</span>
              <span class="summary-value" id="summary-participants">0</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Etapas</span>
              <span class="summary-value" id="summary-stages">0</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Actividades</span>
              <span class="summary-value" id="summary-tasks">0</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">D√≠as del proyecto</span>
              <span class="summary-value" id="summary-days">0</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="tab-content" id="tab-participantes">
      <div class="card scroll-card">
        <div class="card-section">
          <label class="field-label">Nuevo participante</label>
          <div class="field-row participant-row">
            <input id="participant-name" class="field-input" type="text" placeholder="Nombre" />
            <input id="participant-email" class="field-input" type="email" placeholder="Correo (opcional)" />
          </div>
          <div class="field-row">
            <div style="display:flex;gap:6px;align-items:center;width:100%;">
              <select id="participant-role" class="field-input"></select>
              <button id="manage-roles" class="btn-chip" title="Gestionar roles">Editar roles</button>
              <button id="add-participant" class="btn-primary">Agregar</button>
            </div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="card-section list-section">
          <ul id="participants-list" class="list"></ul>
        </div>
      </div>
    </section>

    <section class="tab-content" id="tab-etapas">
      <div class="card scroll-card">
        <div class="card-section">
          <label class="field-label">Nueva etapa / documento</label>
          <div class="field-row">
            <input id="stage-name" class="field-input" type="text" placeholder="Nombre del documento / etapa" />
          </div>
          <div class="field-row">
            <select id="stage-risk" class="field-input">
              <option value="bajo">Riesgo bajo</option>
              <option value="medio">Riesgo medio</option>
              <option value="alto">Riesgo alto</option>
            </select>
          </div>
          <div class="field-row">
            <input
              id="stage-files"
              class="field-input"
              type="file"
              multiple
              accept=".doc,.docx,.pdf,.xls,.xlsx"
            />
            <button id="add-stage" class="btn-primary">Agregar</button>
          </div>
        </div>

        <div class="divider"></div>

        <div class="card-section list-section">
          <ul id="stages-list" class="list"></ul>
        </div>
      </div>
    </section>

    <section class="tab-content" id="tab-calendario">
      <div class="card scroll-card">
        <div class="card-section">
          <div class="card-header-row">
            <span class="card-title">Programaci√≥n por etapas</span>
          </div>
        </div>
        <div class="divider"></div>
        <div class="card-section list-section">
          <ul id="calendar-list" class="list calendar-grid"></ul>
        </div>
      </div>
    </section>

    <section class="tab-content" id="tab-diagrama">
      <div class="card scroll-card">
        <div class="card-section">
          <div class="card-header-row">
            <span class="card-title">Diagrama de Gantt</span>
            <button id="gantt-word-btn" class="btn-chip" title="Descargar informe completo en Word">Descargar Informe en Word</button>
          </div>
        </div>
        <div class="divider"></div>
        <div class="card-section">
          <div id="gantt-container" class="gantt-container"></div>
        </div>
      </div>
    </section>

    <section class="tab-content" id="tab-monitoreo">
      <div class="card scroll-card">
        <div class="card-section">
          <div class="card-header-row">
            <span class="card-title">Monitoreo</span>
          </div>
        </div>
        <div class="divider"></div>
        <div class="card-section">
          <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:8px;">
            <div class="small">Marca actividades en ejecuci√≥n y actualiza % de avance; el avance de la etapa se calcula autom√°ticamente como promedio de sus actividades.</div>
            <button id="monitor-refresh" class="btn-chip">Actualizar gr√°fica</button>
          </div>
          <div id="monitor-grid-wrapper" style="margin-top:6px;">
            <!-- Grid que contendr√° columnas por etapa (3 columnas responsive) -->
            <div id="monitor-grid" class="monitor-grid"></div>
          </div>
        </div>
      </div>
    </section>

    <section class="tab-content" id="tab-ayuda">
      <div class="card scroll-card help-card">
        <div class="help-container">
          <!-- √çndice fijo a la izquierda -->
          <div class="help-toc-fixed">
            <div class="help-toc-title">üìã Temas</div>
            <ul class="help-toc-list">
              <li><a href="javascript:void(0)" data-topic="help-about" class="help-toc-link">¬øQu√© es?</a></li>
              <li><a href="javascript:void(0)" data-topic="help-auditoria" class="help-toc-link">üìã Auditor√≠a</a></li>
              <li><a href="javascript:void(0)" data-topic="help-participantes" class="help-toc-link">üë• Participantes</a></li>
              <li><a href="javascript:void(0)" data-topic="help-etapas" class="help-toc-link">üìÑ Etapas</a></li>
              <li><a href="javascript:void(0)" data-topic="help-calendario" class="help-toc-link">üìÖ Calendario</a></li>
              <li><a href="javascript:void(0)" data-topic="help-diagrama" class="help-toc-link">üìä Diagrama</a></li>
              <li><a href="javascript:void(0)" data-topic="help-example" class="help-toc-link">Ejemplo</a></li>
              <li><a href="javascript:void(0)" data-topic="help-tips" class="help-toc-link">Consejos</a></li>
            </ul>
          </div>
          
          <!-- Contenido scrollable a la derecha -->
          <div class="help-content">
            <!-- ¬øQu√© es? -->
            <div class="help-section active" id="help-about">
              <h2 style="margin: 0 0 12px 0; color: var(--orange); font-size: 16px;">AuditorMonitor</h2>
              <p style="margin: 0 0 10px 0; font-size: 12px; line-height: 1.5;">AuditorMonitor es una plataforma integral dise√±ada para planificar, organizar, monitorear y documentar auditor√≠as de forma eficiente. Permite a los equipos de auditor√≠a centralizar toda la informaci√≥n del proceso, desde la definici√≥n del alcance hasta la presentaci√≥n de resultados.</p>
              
              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Caracter√≠sticas principales:</h4>
              <ul style="margin: 0; padding-left: 16px; font-size: 11px; line-height: 1.5;">
                <li>Gesti√≥n centralizada de auditor√≠as m√∫ltiples</li>
                <li>Registro y seguimiento de participantes con roles definibles</li>
                <li>Creaci√≥n de etapas y actividades con clasificaci√≥n de riesgos</li>
                <li>Calendario interactivo para programaci√≥n de fechas</li>
                <li>Diagrama de Gantt visual para monitoreo del cronograma</li>
                <li>Exportaci√≥n de reportes en Word con informaci√≥n completa</li>
                <li>Importaci√≥n/exportaci√≥n de datos en formato JSON para respaldos</li>
              </ul>
            </div>

            <!-- Secci√≥n Auditor√≠a -->
            <div class="help-section" id="help-auditoria">
              <h2 style="margin: 0 0 12px 0; color: var(--orange); font-size: 15px;">üìã Auditor√≠a</h2>
              <p style="margin: 0 0 10px 0; font-size: 12px; line-height: 1.5;">Define los par√°metros generales de la auditor√≠a: c√≥digo, nombre y auditor l√≠der; los cambios se sincronizan con las dem√°s vistas.</p>
              
              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Campos principales:</h4>
              
              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 12px;">
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">C√≥digo de auditor√≠a</p>
                  <p style="margin: 0; color: var(--text-muted);">Identificador √∫nico de la auditor√≠a. Ej: AUD-2025-01. Cambiar el c√≥digo se consolida al guardar la auditor√≠a.</p>
                </div>
                
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Nombre de auditor√≠a</p>
                  <p style="margin: 0; color: var(--text-muted);">T√≠tulo descriptivo de la auditor√≠a; se usa en listados y en el nombre por defecto al exportar PDF.</p>
                </div>
                
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Auditor l√≠der</p>
                  <p style="margin: 0; color: var(--text-muted);">Seleccionable desde los participantes; solo roles apropiados aparecen como opciones.</p>
                </div>
              </div>

              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Acciones disponibles:</h4>
              <ul style="margin: 0; padding-left: 16px; font-size: 11px; line-height: 1.5;">
                <li><strong>Guardar / actualizar:</strong> Consolida los cambios y actualiza el selector de auditor√≠as.</li>
                <li><strong>Descargar JSON:</strong> Exporta todo el estado para respaldo o transporte entre dispositivos.</li>
                <li><strong>Cargar ejemplo:</strong> Restaura un conjunto de datos de ejemplo completo para probar funcionalidades.</li>
                <li><strong>Cargar JSON:</strong> Importa un archivo JSON previamente exportado.</li>
                <li><strong>Reiniciar:</strong> Recarga la aplicaci√≥n (pide confirmaci√≥n).</li>
              </ul>

              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Resumen:</h4>
              <p style="margin: 0 0 8px 0; font-size: 11px; line-height: 1.5;">Resumen din√°mico que muestra participantes, etapas, actividades y d√≠as del proyecto; se recalcula autom√°ticamente cuando actualizas fechas o contenidos.</p>
            </div>

            <!-- Secci√≥n Participantes -->
            <div class="help-section" id="help-participantes">
              <h2 style="margin: 0 0 12px 0; color: var(--orange); font-size: 15px;">üë• Participantes</h2>
              <p style="margin: 0 0 10px 0; font-size: 12px; line-height: 1.5;">Registra el equipo de la auditor√≠a; la lista se muestra en tres columnas para ahorrar espacio y facilitar la lectura.</p>
              
              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Informaci√≥n del participante:</h4>
              
              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 12px;">
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Nombre</p>
                  <p style="margin: 0; color: var(--text-muted);">Nombre completo del participante (requerido). Ej: "Ana Mar√≠a Torres G√≥mez".</p>
                </div>
                
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Correo electr√≥nico</p>
                  <p style="margin: 0; color: var(--text-muted);">Correo (opcional). √ötil para contacto y exportaci√≥n de listados.</p>
                </div>
                
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Rol</p>
                  <p style="margin: 0; color: var(--text-muted);">Define la funci√≥n del participante. Edita la lista de roles con "Editar roles" si necesitas personalizarla.</p>
                </div>
              </div>

              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Operaciones disponibles:</h4>
              <ul style="margin: 0; padding-left: 16px; font-size: 11px; line-height: 1.5;">
                <li><strong>Editar roles:</strong> Personaliza la lista de roles disponibles.</li>
                <li><strong>Editar (‚úé):</strong> Abre un editor modal para modificar nombre, correo y rol.</li>
                <li><strong>Eliminar (üóë):</strong> Remueve un participante de la auditor√≠a.</li>
              </ul>
            </div>

            <!-- Secci√≥n Etapas -->
            <div class="help-section" id="help-etapas">
              <h2 style="margin: 0 0 12px 0; color: var(--orange); font-size: 15px;">üìÑ Etapas</h2>
              <p style="margin: 0 0 10px 0; font-size: 12px; line-height: 1.5;">Las etapas definen las fases principales; la lista de etapas se presenta en columnas para optimizar el espacio y la navegaci√≥n.</p>
              
              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Componentes de una etapa:</h4>
              
              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 12px;">
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Nombre de etapa</p>
                  <p style="margin: 0; color: var(--text-muted);">T√≠tulo descriptivo de la fase, visible en la vista de etapas, calendario y Gantt.</p>
                </div>
                
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Nivel de riesgo</p>
                  <p style="margin: 0; color: var(--text-muted);">Clasificaci√≥n r√°pida (bajo/medio/alto) para priorizar esfuerzos.</p>
                </div>
                
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Fechas (inicio y fin)</p>
                  <p style="margin: 0; color: var(--text-muted);">Las fechas de etapa se editan desde "Editar etapa" y se reflejan autom√°ticamente en el Calendario y en el diagrama de Gantt.</p>
                </div>
                
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Adjuntos</p>
                  <p style="margin: 0; color: var(--text-muted);">Documentos vinculados a la etapa; se listan los nombres para referencia r√°pida.</p>
                </div>
              </div>

              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Actividades dentro de etapas:</h4>
              <p style="margin: 0 0 8px 0; font-size: 11px; line-height: 1.5;">Las actividades se crean con un modal que solicita nombre, descripci√≥n y fechas; estas fechas se sincronizan con el Calendario y el Gantt.</p>
              
              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Operaciones disponibles:</h4>
              <ul style="margin: 0; padding-left: 16px; font-size: 11px; line-height: 1.5;">
                <li><strong>Editar etapa:</strong> Abre un editor donde puedes cambiar nombre, riesgo y las fechas de la etapa (las fechas en la vista de etapas son de solo lectura y deben ajustarse aqu√≠).</li>
                <li><strong>Eliminar etapa:</strong> Remueve la etapa y sus actividades (pide confirmaci√≥n).</li>
                <li><strong>Agregar actividad:</strong> Abre un modal para ingresar nombre, descripci√≥n y fechas de la actividad dentro de la etapa.</li>
                <li><strong>Editar actividad (‚úé):</strong> Modifica nombre, fechas y descripci√≥n mediante el modal.</li>
                <li><strong>Eliminar actividad (üóë):</strong> Elimina la actividad.</li>
              </ul>
            </div>

            <!-- Secci√≥n Calendario -->
            <div class="help-section" id="help-calendario">
              <h2 style="margin: 0 0 12px 0; color: var(--orange); font-size: 15px;">üìÖ Calendario</h2>
              <p style="margin: 0 0 10px 0; font-size: 12px; line-height: 1.5;">Vista por columnas donde cada etapa tiene sus campos de fecha; las modificaciones aqu√≠ actualizan el Gantt en tiempo real.</p>
              
              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">C√≥mo usar el Calendario:</h4>
              
              <div style="background: #fffbf0; border-left: 3px solid var(--orange); padding: 10px; border-radius: 6px; font-size: 11px; margin-bottom: 10px; line-height: 1.5;">
                <p style="margin: 0 0 6px 0; font-weight: 600;">Estructura por columnas</p>
                <p style="margin: 0; color: var(--text-muted);">Cada columna representa una etapa; adem√°s se listan las actividades con sus propios campos de fecha para un control detallado.</p>
              </div>

              <div style="background: #fffbf0; border-left: 3px solid var(--orange); padding: 10px; border-radius: 6px; font-size: 11px; margin-bottom: 10px; line-height: 1.5;">
                <p style="margin: 0 0 6px 0; font-weight: 600;">Ingresar fechas</p>
                <p style="margin: 0; color: var(--text-muted);">Usa los pickers de fecha para establecer inicio/fin. Nota: las fechas de etapa se deben modificar desde "Editar etapa" (la vista de etapas muestra esas fechas como solo lectura), mientras que las fechas de actividad s√≠ se pueden editar directamente aqu√≠.</p>
              </div>

              <div style="background: #fffbf0; border-left: 3px solid var(--orange); padding: 10px; border-radius: 6px; font-size: 11px; margin-bottom: 10px; line-height: 1.5;">
                <p style="margin: 0 0 6px 0; font-weight: 600;">Sincronizaci√≥n con otras vistas</p>
                <p style="margin: 0; color: var(--text-muted);">Los cambios de fecha en el Calendario se sincronizan autom√°ticamente con Etapas y el Gantt; el diagrama se recalcula y se autoajusta para mostrar todas las etapas y actividades.</p>
              </div>

              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Consejos:</h4>
              <ul style="margin: 0; padding-left: 16px; font-size: 11px; line-height: 1.5;">
                <li>Programa etapas en secuencia l√≥gica respetando dependencias.</li>
                <li>Asigna actividades dentro de ventanas de tiempo realistas.</li>
                <li>Incluye buffer de tiempo entre etapas para revisiones y ajustes.</li>
                <li>Actualiza fechas regularmente; el Gantt se ajustar√° autom√°ticamente.</li>
              </ul>
            </div>

            <!-- Secci√≥n Diagrama -->
            <div class="help-section" id="help-diagrama">
              <h2 style="margin: 0 0 12px 0; color: var(--orange); font-size: 15px;">üìä Diagrama (Gantt)</h2>
              <p style="margin: 0 0 10px 0; font-size: 12px; line-height: 1.5;">El diagrama de Gantt muestra todas las etapas y actividades con sus duraciones; se recalcula y se autoajusta cuando agregas o modificas fechas para mostrar todo el contenido disponible.</p>
              
              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Componentes y lectura:</h4>
              
              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 12px;">
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Componentes del diagrama</p>
                  <p style="margin: 0 0 6px 0; color: var(--text-muted);"><strong>Barras de etapas (naranja oscuro):</strong> Representan la duraci√≥n completa de cada etapa.</p>
                  <p style="margin: 0; color: var(--text-muted);"><strong>Barras de actividades (verde):</strong> Representan tareas espec√≠ficas; su posici√≥n y largo se derivan de las fechas ingresadas en el Calendario o en el editor de actividad.</p>
                </div>

                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Lectura del diagrama</p>
                  <ul style="margin: 0; padding-left: 12px; font-size: 11px; line-height: 1.5;">
                    <li><strong>Eje horizontal:</strong> L√≠nea de tiempo (d√≠as del proyecto).</li>
                    <li><strong>Eje vertical:</strong> Listado de etapas y sus actividades.</li>
                    <li><strong>Largo de barra:</strong> Indica la duraci√≥n de la etapa o actividad.</li>
                    <li><strong>Posici√≥n:</strong> Indica el momento de inicio del elemento.</li>
                  </ul>
                </div>

                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Interpretaci√≥n de patrones</p>
                  <ul style="margin: 0; padding-left: 12px; font-size: 11px; line-height: 1.5;">
                    <li><strong>Barras solapadas:</strong> Actividades simult√°neas (recursos paralelos).</li>
                    <li><strong>Barras secuenciales:</strong> Actividades en orden (dependencia clara).</li>
                    <li><strong>Espacios vac√≠os:</strong> Per√≠odos sin actividades (pueden ser deliberados).</li>
                  </ul>
                </div>
              </div>

              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Exportar a PDF:</h4>
              <p style="margin: 0 0 8px 0; font-size: 11px; line-height: 1.5;">El bot√≥n "Descargar Informe en PDF" (naranja claro) genera un documento que incluye datos generales, participantes, etapas y el diagrama; puedes ingresar un nombre de archivo antes de descargar.</p>
            </div>

            <!-- Secci√≥n Ejemplo -->
            <div class="help-section" id="help-example">
              <h2 style="margin: 0 0 12px 0; color: var(--orange); font-size: 15px;">Ejemplo pr√°ctico</h2>
              <p style="margin: 0 0 10px 0; font-size: 12px; line-height: 1.5;">A continuaci√≥n, un caso de uso completo que ilustra c√≥mo utilizar todas las funcionalidades de AuditorMonitor de forma integrada.</p>
              
              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Escenario: Auditor√≠a financiera integral 2025</h4>
              
              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 12px;">
                <div style="background: #fffbf0; border-left: 3px solid var(--orange); padding: 10px; border-radius: 6px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">1. Datos generales</p>
                  <p style="margin: 0;"><strong>C√≥digo:</strong> AUD-2025-FIN-01<br/><strong>Nombre:</strong> Auditor√≠a integral de procesos financieros y contables 2025<br/><strong>Auditor l√≠der:</strong> Ana Torres</p>
                </div>

                <div style="background: #fffbf0; border-left: 3px solid var(--orange); padding: 10px; border-radius: 6px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">2. Equipo de participantes</p>
                  <ul style="margin: 0; padding-left: 16px; font-size: 10px;">
                    <li>Ana Torres (Auditor l√≠der)</li>
                    <li>Luis P√©rez (Auditor)</li>
                    <li>Mar√≠a G√≥mez (Responsable)</li>
                    <li>Carlos Rivas (Responsable)</li>
                    <li>Elena N√∫√±ez (Observadora)</li>
                  </ul>
                </div>

                <div style="background: #fffbf0; border-left: 3px solid var(--orange); padding: 10px; border-radius: 6px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">3-5. Etapas, documentos y monitoreo</p>
                  <p style="margin: 0 0 4px 0; font-size: 10px;"><strong>4 etapas:</strong> Planeaci√≥n (bajo), Revisi√≥n documentos (alto), Pruebas (medio), Informe (medio)</p>
                  <p style="margin: 0 0 4px 0; font-size: 10px;"><strong>Documentos:</strong> PDF, Excel, Word por etapa</p>
                  <p style="margin: 0; font-size: 10px;"><strong>Monitoreo:</strong> Ajusta fechas en Calendario y descarga informe PDF cuando est√© lista la planificaci√≥n.</p>
                </div>
              </div>
            </div>

            <!-- Secci√≥n Consejos -->
            <div class="help-section" id="help-tips">
              <h2 style="margin: 0 0 12px 0; color: var(--orange); font-size: 15px;">Consejos y mejores pr√°cticas</h2>
              <p style="margin: 0 0 10px 0; font-size: 12px; line-height: 1.5;">Recomendaciones para aprovechar al m√°ximo AuditorMonitor y garantizar auditor√≠as bien organizadas y documentadas.</p>
              
              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Gesti√≥n de datos:</h4>
              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 12px;">
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Respaldos regulares</p>
                  <p style="margin: 0; color: var(--text-muted);">Descarga archivos JSON semanalmente para evitar p√©rdida de informaci√≥n.</p>
                </div>
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">C√≥digos descriptivos</p>
                  <p style="margin: 0; color: var(--text-muted);">Usa formatos consistentes como AUD-AAAA-TIPO-NUM para f√°cil identificaci√≥n.</p>
                </div>
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Actualizaci√≥n constante</p>
                  <p style="margin: 0; color: var(--text-muted);">Mant√©n fechas y participantes sincronizados con cambios reales en el proyecto.</p>
                </div>
              </div>

              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 12px;">
                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Planificaci√≥n</p>
                  <ul style="margin: 0; padding-left: 16px;">
                    <li><strong>Auditor l√≠der:</strong> Asigna siempre un auditor l√≠der claramente identificado antes de comenzar.</li>
                    <li><strong>Roles claros:</strong> Define roles espec√≠ficos para cada participante para evitar duplicidad.</li>
                    <li><strong>Tiempo realista:</strong> No congestes el cronograma; incluye tiempo para revisiones y ajustes.</li>
                    <li><strong>Riesgos identificados:</strong> Usa la clasificaci√≥n de riesgos para priorizar etapas cr√≠ticas.</li>
                  </ul>
                </div>

                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Documentaci√≥n</p>
                  <ul style="margin: 0; padding-left: 16px;">
                    <li><strong>Adjuntos organizados:</strong> Carga documentos relacionados a su etapa correspondiente para referencia r√°pida.</li>
                    <li><strong>Descripciones en actividades:</strong> Agrega breves descripciones que aclaren el prop√≥sito de cada actividad.</li>
                    <li><strong>Exporta PDF:</strong> Genera reportes PDF cuando la planificaci√≥n sea aprobada como documento de control.</li>
                  </ul>
                </div>

                <div style="background: #fafafa; border-radius: 8px; padding: 10px; font-size: 11px; line-height: 1.5;">
                  <p style="margin: 0 0 6px 0; font-weight: 600;">Seguimiento</p>
                  <ul style="margin: 0; padding-left: 16px;">
                    <li><strong>Gantt como referencia:</strong> Revisa el diagrama regularmente para identificar desviaciones al cronograma.</li>
                    <li><strong>Ajustes √°giles:</strong> Modifica fechas en el Calendario en tiempo real si emergen cambios.</li>
                    <li><strong>Participantes informados:</strong> Mant√©n contacto de correos actualizados para comunicaciones efectivas.</li>
                    <li><strong>Hitos importantes:</strong> Marca claramente las fechas de cierre de cada etapa para monitoreo.</li>
                  </ul>
                </div>
              </div>

              <h4 style="margin: 12px 0 8px 0; color: var(--text-main); font-size: 12px; font-weight: 600;">Personalizaci√≥n de roles:</h4>
              <p style="margin: 0 0 8px 0; font-size: 11px; line-height: 1.5;">Si los roles est√°ndar no se ajustan a tu estructura organizacional, usa "Editar roles" en Participantes para crear roles personalizados espec√≠ficos de tu contexto (ej: "Especialista t√©cnico", "Coordinador de auditor√≠a", etc.).</p>

              <div style="background: #e8f5e9; border-left: 3px solid #43a047; padding: 10px; border-radius: 6px; font-size: 11px; margin-top: 12px; line-height: 1.5;">
                <p style="margin: 0; font-weight: 600;">üí° Tip final:</p>
                <p style="margin: 0; color: #333;">Carga el ejemplo de datos proporcionado ("Cargar ejemplo") para explorar todas las funcionalidades en contexto real. Esto te familiarizar√° r√°pidamente con la plataforma.</p>
              </div>
            </div>

            <p style="margin-top: 16px; padding-top: 12px; border-top: 1px solid #ddd; font-size: 9px; text-align: center; color: #666; margin-bottom: 8px;">¬© 2025 AuditorMonitor | Carlos Alfredo Castillo Flores - ITCPO | Todos los derechos reservados</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal gen√©rico per messaggi e cattura testo -->
  <div id="app-modal-backdrop" class="modal-backdrop hidden">
    <div class="modal">
      <div class="modal-title" id="modal-title"></div>
      <div class="modal-message" id="modal-message"></div>
      <div class="modal-input-wrapper hidden" id="modal-input-wrapper">
        <input id="modal-input" class="field-input" type="text" />
      </div>
      <div class="modal-actions">
        <button id="modal-cancel" class="btn-chip">Cancelar</button>
        <button id="modal-ok" class="btn-primary">Aceptar</button>
      </div>
    </div>
  </div>
</body>
</html>

